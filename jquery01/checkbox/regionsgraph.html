<html>
<head>
    <title>jQuery Sample</title>
    <script src ="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"> </script> 
    <script src ="data.js"> </script> 
    <style>
        .level1 {
            margin-bottom: 10px;
            margin-left: 100px;
        }
        .level2 {
            margin-left: 100px;
        }
        .level3 {
            margin-left: 100px;
        }
    </style>
</head>
<body>
    <div id="graph">
    </div>
    <script>
        var regionsDict = {};
        var subRegions = regionsGraph.subregions;
        var members = subRegions.members;
        
        for (var i = 0; i < members.length; i++) {
            regionsDict[members[i].shippingRegionId] = members[i];
        }

        var graph = document.getElementById("graph");

        for (var i = 0; i < regionsGraph.parentShippingRegion.subregionIds.length; i++) {
            process(regionsGraph.parentShippingRegion.subregionIds[i], 1, graph);
        }

        function process(subRegionId, level, container) {
            if (regionsDict[subRegionId]) {
                var subRegion = regionsDict[subRegionId]
                var className = 'level' + level;

                //process root
                var div = document.createElement('div');
                div.className = className;
                
                var cb = document.createElement('input');
                cb.type = 'checkbox';
                cb.name = 'region[]';
                cb.value = subRegion.shippingRegionId;
                cb.id = subRegion.shippingRegionId;

                cb.addEventListener('change', function (e){
                    console.log(this.value);
                });

                var lbl = document.createElement('label');
                lbl.htmlFor = subRegion.shippingRegionId;
                lbl.appendChild(document.createTextNode(subRegion.displayName));

                div.appendChild(cb);
                div.appendChild(lbl);

                container.appendChild(div);

                if (subRegion.subregionIds.length > 0) {

                }

                //recursive call
                for (var i = 0; i < subRegion.subregionIds.length; i++) {
                    process(subRegion.subregionIds[i], level + 1, div);
                }
            }
        }
    </script>
</body>
</html>
